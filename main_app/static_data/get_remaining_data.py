from data_getter import get_data

datasets = [
    {'url': 'https://www.nomisweb.co.uk/api/v01/dataset/NM_189_1.data.csv?geography=1811939329...1811939332,1811939334...1811939336,1811939338...1811939428,1811939436...1811939442,1811939768,1811939769,1811939443...1811939497,1811939499...1811939501,1811939503,1811939505...1811939507,1811939509...1811939517,1811939519,1811939520,1811939524...1811939570,1811939575...1811939599,1811939601...1811939628,1811939630...1811939634,1811939636...1811939647,1811939649,1811939655...1811939664,1811939667...1811939680,1811939682,1811939683,1811939685,1811939687...1811939704,1811939707,1811939708,1811939710,1811939712...1811939717,1811939719,1811939720,1811939722...1811939730&industry=146800641...146800643,146800645...146800673,146800675...146800679,146800681...146800683,146800685...146800687,146800689...146800693,146800695,146800696,146800698...146800706,146800708...146800715,146800717...146800722,146800724...146800728,146800730...146800739&employment_status=1...3&measure=1,2&measures=20100&select=date_name,geography_name,geography_code,industry_name,employment_status_name,measure_name,measures_name,obs_value,obs_status_name&RecordOffset=',
     'folder_name': 'business_register',
     'prefix': 'bre',
     'filename': 'business_register_and_employment_survey.csv',
     'requests': 1341648
     },
     {'url': 'https://www.nomisweb.co.uk/api/v01/dataset/NM_57_1.data.csv?geography=1811939329...1811939332,1811939334...1811939336,1811939338...1811939428,1811939436...1811939442,1811939768,1811939769,1811939443...1811939497,1811939499...1811939501,1811939503,1811939505...1811939507,1811939509...1811939517,1811939519,1811939520,1811939524...1811939570,1811939575...1811939599,1811939601...1811939628,1811939630...1811939634,1811939636...1811939647,1811939649,1811939655...1811939664,1811939667...1811939680,1811939682,1811939683,1811939685,1811939687...1811939704,1811939707,1811939708,1811939710,1811939712...1811939717,1811939719,1811939720,1811939722...1811939730,1811939757...1811939767&date=latestMINUS8-latest&item=1,3&measures=20100&select=date_name,geography_name,geography_code,item_name,measures_name,obs_value,obs_status_name&RecordOffset=',
     'folder_name': 'jobs_density',
     'prefix': 'jd',
     'filename': 'jobs_density.csv',
     'requests': 6732
     },
     {'url': 'https://www.nomisweb.co.uk/api/v01/dataset/NM_207_1.data.csv?geography=1811939329...1811939332,1811939334...1811939336,1811939338...1811939428,1811939436...1811939442,1811939768,1811939769,1811939443...1811939497,1811939499...1811939501,1811939503,1811939505...1811939507,1811939509...1811939517,1811939519,1811939520,1811939524...1811939570,1811939575...1811939599,1811939601...1811939628,1811939630...1811939634,1811939636...1811939647,1811939649,1811939655...1811939664,1811939667...1811939680,1811939682,1811939683,1811939685,1811939687...1811939692&measure=1,3,4,12,5...11&measures=20100&select=date_name,geography_name,geography_code,measure_name,measures_name,obs_value,obs_status_name&RecordOffset=',
     'folder_name': 'fertility',
     'prefix': 'fert',
     'filename': 'fertility.csv',
     'requests': 32769
     },
     {'url': 'https://www.nomisweb.co.uk/api/v01/dataset/NM_2002_1.data.csv?geography=1811939329...1811939332,1811939334...1811939336,1811939338...1811939428,1811939436...1811939442,1811939768,1811939769,1811939443...1811939497,1811939499...1811939501,1811939503,1811939505...1811939507,1811939509...1811939517,1811939519,1811939520,1811939524...1811939570,1811939575...1811939599,1811939601...1811939628,1811939630...1811939634,1811939636...1811939647,1811939649,1811939655...1811939664,1811939667...1811939680,1811939682,1811939683,1811939685,1811939687...1811939704,1811939707,1811939708,1811939710,1811939712...1811939717,1811939719,1811939720,1811939722...1811939730,1811939757...1811939767&date=latestMINUS8-latest&gender=0...2&c_age=200...203,250,207...209&measures=20100&select=date_name,geography_name,geography_code,gender_name,c_age_name,measures_name,obs_value,obs_status_name&RecordOffset=',
     'folder_name': 'population',
     'prefix': 'pop',
     'filename': 'population.csv',
     'requests': 80784
     },
     {'url': 'https://www.nomisweb.co.uk/api/v01/dataset/NM_185_1.data.csv?geography=1811939329...1811939332,1811939334...1811939336,1811939338...1811939428,1811939436...1811939442,1811939768,1811939769,1811939443...1811939497,1811939499...1811939501,1811939503,1811939505...1811939507,1811939509...1811939517,1811939519,1811939520,1811939524...1811939570,1811939575...1811939599,1811939601...1811939628,1811939630...1811939634,1811939636...1811939647,1811939649,1811939655...1811939664,1811939667...1811939680,1811939682,1811939683,1811939685,1811939687...1811939704,1811939707,1811939708,1811939710,1811939712...1811939717,1811939719,1811939720,1811939722...1811939730,1811939757...1811939767&date=latestMINUS7-latest&component_of_gdhi=0&measure=1...5&measures=20100&select=date_name,geography_name,geography_code,component_of_gdhi_name,measure_name,measures_name,obs_value,obs_status_name&RecordOffset=',
     'folder_name': 'disposable_income',
     'prefix': 'disp',
     'filename': 'disposable_income.csv',
     'requests': 14960
     },
     {'url': 'https://www.nomisweb.co.uk/api/v01/dataset/NM_142_1.data.csv?geography=1811939329...1811939332,1811939334...1811939336,1811939338...1811939428,1811939436...1811939442,1811939768,1811939769,1811939443...1811939497,1811939499...1811939501,1811939503,1811939505...1811939507,1811939509...1811939517,1811939519,1811939520,1811939524...1811939570,1811939575...1811939599,1811939601...1811939628,1811939630...1811939634,1811939636...1811939647,1811939649,1811939655...1811939664,1811939667...1811939680,1811939682,1811939683,1811939685,1811939687...1811939704,1811939707,1811939708,1811939710,1811939712...1811939717,1811939719,1811939720,1811939722...1811939730,1811939757...1811939767&date=latestMINUS9-latest&industry=150994945...150994965&employment_sizeband=0,10,1,2,20,3,4,30,5,6,40,7...9&legal_status=0,10,20&measures=20100&select=date_name,geography_name,geography_code,industry_name,employment_sizeband_name,legal_status_name,measures_name,obs_value,obs_status_name&RecordOffset=',
     'folder_name': 'business_counts',
     'prefix': 'bus_count',
     'filename': 'business_counts.csv',
     'requests': 3298680
     }
]

for dataset in datasets:
    get_data(dataset['url'],dataset['folder_name'],dataset['prefix'],dataset['filename'],dataset['requests'])